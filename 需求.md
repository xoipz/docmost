# 日记功能需求文档

## 功能概述
为 Docmost 添加日记功能，允许用户在工作区中切换到日记模式，提供基于日历的日记管理体验。

## 核心需求

### 1. 工作区模式切换
- **功能描述**: 在现有工作区基础上添加日记模式切换选项
- **交互方式**: 用户可以随时在普通模式和日记模式之间切换
- **实现位置**: 需要在工作区界面添加模式切换控件

### 2. 日历功能
- **显示位置**: 在"最近更新"上方，具体修改 `apps\client\src\features\space\components\space-home-tabs.tsx` 的布局
- **日历视图**: 支持月视图和年视图切换
- **日记状态提示**: 
  - 有日记的日期显示圆点并高亮
  - 需要适配暗黑模式
- **交互行为**: 双击日历日期创建/编辑对应日期的日记，并自动跳转到编辑界面

### 3. 日记笔记管理
- **创建限制**: 每天只能创建一篇日记
- **数据结构**: 日记笔记与普通笔记在数据结构上保持一致
- **存储标识**: 需要添加标识区分日记笔记和普通笔记

### 4. 界面布局调整
- **左侧页面栏**: 
  - 上半部分: 日历栏
  - 下半部分: 按创建时间排序的日记列表
  - 原页面树状结构: 保留在日历栏下方
- **日记列表显示**:
  - 显示内容: 日记标题 + 创建时间
  - 时间格式: 2024-01-15
  - 分组方式: 按月分成文件夹，命名格式为"2024年1月"
  - 排序方式: 按创建时间排序

## 技术实现要点

### 前端修改
1. **布局调整**
   - 修改 `space-home-tabs.tsx` 添加日历组件
   - 调整左侧边栏布局，添加日历和日记列表区域

2. **日历组件**
   - 开发月视图/年视图切换功能
   - 实现日记状态标识（圆点+高亮）
   - 适配暗黑模式
   - 双击事件处理

3. **日记列表组件**
   - 按月分组显示
   - 时间格式化
   - 与日历联动

### 数据层
1. **日记标识**
   - 添加字段标识笔记类型（普通/日记）
   - 日期关联字段

2. **查询逻辑**
   - 按日期查询日记
   - 按月分组查询
   - 日历状态查询

### 状态管理
1. **模式切换**
   - 普通模式/日记模式状态管理
   - 界面布局切换

2. **日历状态**
   - 当前选中日期
   - 有日记的日期列表
   - 视图模式（月/年）

## 国际化
需要在 `apps\client\public\locales\zh-CN\translation.json` 中添加相关中文翻译：
- 日记模式
- 月视图/年视图
- 日记列表相关文本
- 月份名称等

## 注意事项
1. 保持与现有功能的兼容性
2. 确保暗黑模式适配
3. 响应式设计考虑
4. 性能优化（大量日记数据的处理）
5. 数据备份和迁移考虑

## 暂时搁置的功能
- "创建/跳转当天笔记"独立按钮功能